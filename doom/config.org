;;; $DOOMDIR/config.el -*- lexical-binding: t; -*-

* Generic
** Personal Info
#+begin_src emacs-lisp :tangle yes
(setq user-full-name "Bart Frenk"
      user-mail-address "bart.frenk@gmail.com")
#+end_src

** Core
The command =save-buffer= is bound to =C-x C-s=, while =save-some-buffers= is
bound to =C-x s=. These keybindings are easy to mix up while typing; that is
annoying since the latter command steals focus to the minibuffer while waiting
for a response.

#+begin_src emacs-lisp :tangle yes
(global-unset-key (kbd "C-x s"))
#+end_src

** Appearance
#+begin_src emacs-lisp :tangle yes
(setq doom-theme 'doom-vibrant)
(setq doom-modeline-height 25)
#+end_src

#+begin_src emacs-lisp :tangle yes
(setq doom-font (font-spec :family "SauceCodePro NerdFont" :size 12))
(setq display-line-numbers-type t)
(setq line-spacing 5)
#+end_src

* Languages
** Org
#+begin_src emacs-lisp :tangle yes
(setq org-directory "~/documents/org/")
#+end_src

** Python
#+begin_src emacs-lisp :tangle yes
(after! python
  (set-eglot-client! '(python-mode python-ts-mode)
                     '("pyright-langserver" "--stdio")
                     '("ruff" "server")))

(defun activate-venv ()
  (interactive)
  (if-let ((root-dir (projectile-project-root)))
      (let ((venv-dir (concat (file-name-as-directory root-dir) ".venv")))
        (pyvenv-activate venv-dir)
        (message "Activated virtualenv at %s" venv-dir))
    (message "Could not find virtualenv")))

(after! python
  (use-package! python-black
    :demand t
    :after python)
(add-hook! 'python-mode-hook #'python-black-on-save-mode))

#+end_src

- [ ] Automatically restart eglot when switching virtualenv
- [ ] Automatically reset virtualenv (and restart eglot) when switching project

** Lisp
#+begin_src emacs-lisp :tangle yes
(after! parinfer
  (setq parinfer-rust-preferred-mode "paren"))
#+end_src

- [ ] Use paredit instead of parinfer

** Shell Scripts
#+begin_src emacs-lisp :tangle yes
(add-to-list 'auto-mode-alist '("\\.zsh-theme\\'" . bash-ts-mode))
#+end_src
